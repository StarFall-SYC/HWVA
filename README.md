# Humanoid Web Vulnerability Assistant

## 项目介绍

Humanoid Web Vulnerability Assistant是一款浏览器扩展，专为网站安全测试和漏洞检测而设计。它通过模拟真实人类用户的行为，对网站进行各种安全测试，同时保持合规性和不可检测性。

## 主要功能

### 1. 漏洞检测与分析
- **多种漏洞检测**：支持XSS、SQL注入、CSRF、SSRF、敏感信息泄露、不安全HTTP头部等多种漏洞检测
- **智能分析**：能够自动分析检测结果，评估漏洞严重程度
- **报告生成**：提供详细的漏洞报告，包括漏洞类型、位置、严重程度等信息

### 2. 人类行为模拟
- **真实用户行为**：模拟真实人类的浏览模式、鼠标移动、点击行为和键盘输入
- **注意力模式**：模拟人类的注意力集中和分散特性
- **自然交互**：包括阅读速度、滚动行为、决策模式等多种人类特征

### 3. 浏览器指纹混淆
- **全方位保护**：混淆用户代理、屏幕分辨率、Canvas、WebRTC、字体、硬件信息等浏览器指纹
- **动态指纹**：支持动态变化的指纹特征，避免被识别为机器人
- **TCP/IP指纹混淆**：通过修改网络请求特征，进一步隐藏真实身份

### 4. 自定义配置
- **检测深度控制**：支持调整漏洞检测的深度和强度
- **漏洞类型选择**：可选择需要检测的漏洞类型
- **人类行为调整**：可以调整人类行为模拟的各项参数

## 支持的漏洞类型详解

### XSS（跨站脚本）
- **反射型XSS**：分析URL参数和表单提交后的响应，识别未经过滤的输入反射
- **存储型XSS**：检测存储在服务器上的恶意脚本是否被渲染
- **DOM型XSS**：监控DOM操作方法，识别客户端脚本漏洞

### SQL注入
- **错误型注入**：分析SQL错误消息，识别注入点
- **布尔型盲注**：通过逻辑测试确认注入存在
- **时间型盲注**：使用时间延迟函数检测注入点

### CSRF（跨站请求伪造）
- **分析表单保护机制**：检查是否存在有效的CSRF令牌
- **检测请求头验证**：评估Referer/Origin验证措施
- **测试跨域请求**：评估是否允许未经验证的跨域请求

### SSRF（服务器端请求伪造）
- **内部资源探测**：检测是否可以访问内部资源
- **协议解析漏洞**：测试各种URL协议和格式的处理
- **重定向问题**：分析服务器重定向处理逻辑

### 敏感信息泄露
- **应用错误信息**：识别包含敏感信息的错误信息
- **源代码泄露**：检测可访问的源代码文件和备份文件
- **配置信息泄露**：发现系统配置信息和密钥

### HTTP安全头部检测
- **缺失的安全头部**：检查CSP、X-XSS-Protection等安全头部
- **不安全的设置**：识别安全头部的不安全配置
- **CORS设置分析**：评估跨域资源共享策略

## 漏洞检测算法优化

为提高漏洞检测的准确率、效率和隐蔽性，本项目对漏洞检测算法进行了深度优化：

### 上下文感知检测引擎

- **智能载荷生成**：基于输入字段类型、名称和上下文自动生成最适合的测试载荷
- **动态变异算法**：根据服务器响应实时调整和变异测试载荷，绕过WAF和过滤器
- **多阶段验证**：采用预检测、主测试和验证三阶段策略，降低误报率
- **递进式探测深度**：从低风险测试开始，根据响应逐步深入，减少对目标系统的影响

### 高级XSS检测优化

- **上下文感知载荷**：根据注入点的HTML/JavaScript/CSS上下文生成特定的XSS载荷
- **DOM变化监控**：使用MutationObserver监控DOM变化，检测动态注入的恶意代码
- **事件触发检测**：模拟用户事件触发潜在的XSS漏洞
- **沙箱执行环境**：在隔离环境中执行可疑代码，防止对当前页面造成影响
- **多向量检测**：同时覆盖HTML属性、JavaScript、CSS和URL编码等多种注入向量

### SQL注入检测增强

- **延时分析算法**：精确测量时间差异，检测盲注漏洞，自动调整延时阈值
- **错误指纹库**：维护常见数据库错误信息指纹库，快速识别SQL注入漏洞
- **启发式语法分析**：分析SQL语法结构，构造更精准的测试载荷
- **差分响应分析**：比较正常请求和测试请求的响应差异，发现细微变化
- **自适应测试深度**：根据初步检测结果自动调整测试的深度和广度

### CSRF保护评估优化

- **令牌提取与分析**：自动识别和提取CSRF令牌，分析其生成机制和有效性
- **请求伪造测试**：构造符合目标站点格式的跨站请求，测试防护机制
- **同源策略测试**：评估目标站点对同源策略的实施情况
- **会话管理分析**：分析会话管理机制与CSRF保护的关联
- **多步骤请求检测**：测试涉及多个步骤的操作流程中的CSRF漏洞

### 智能决策系统

- **漏洞关联分析**：识别不同漏洞之间的关联，发现复合型安全问题
- **风险评分模型**：根据漏洞类型、攻击面、潜在影响和利用难度计算风险评分
- **自学习能力**：记录历史检测结果，不断优化检测策略和参数
- **启发式规则引擎**：基于安全专家经验构建的启发式规则，提高检测精度
- **异常模式识别**：识别网站响应中的异常模式，发现潜在安全问题

### 低延迟并行检测

- **智能任务调度**：根据依赖关系和优先级调度漏洞检测任务
- **微线程执行模型**：使用非阻塞异步调用，实现高并发低延迟检测
- **资源自适应控制**：根据系统资源动态调整检测任务数量和强度
- **增量式检测策略**：优先检测高风险区域，逐步扩展到整个应用
- **请求限流与间隔**：智能控制请求频率，避免触发防护机制

### 隐蔽性优化

- **流量指纹伪装**：模拟不同浏览器的流量特征，避免被识别为安全工具
- **请求随机化**：随机化请求间隔、顺序和参数，模拟真实用户行为
- **载荷混淆技术**：对测试载荷进行混淆和编码，绕过WAF检测
- **渐进式测试强度**：逐步提高测试强度，避免触发异常检测系统
- **人类行为融合**：将漏洞检测操作融入到模拟的人类浏览行为中

### 负载生成器高级功能

- **多语言载荷生成**：针对不同编程语言和框架生成特定的测试载荷
- **上下文敏感编码**：根据不同上下文自动应用适当的编码和转义
- **模糊测试引擎**：结合确定性测试和随机模糊测试，提高漏洞覆盖率
- **自定义载荷模板**：支持用户定义和扩展测试载荷模板
- **多级别规避技术**：内置多种WAF规避技术，应对不同的防护系统

## 人类行为模拟系统详解

### 高级人格类型系统
- **条理型人格**：高精度鼠标操作，深度阅读，有序浏览
- **冲动型人格**：快速鼠标移动，浅度阅读，跳跃式浏览
- **细致型人格**：扩展阅读时间，高专注度，多次检查
- **随意型人格**：多样化探索，不规则滚动，分散注意力

### 真实鼠标轨迹生成
- **贝塞尔曲线算法**：生成平滑自然的鼠标轨迹
- **Fitts定律应用**：根据目标大小和距离计算鼠标移动时间
- **微小抖动添加**：在移动轨迹中加入人类手部抖动特征
- **加速度与减速模拟**：模拟自然的起步和停止过程

### 视觉注意力模拟
- **中央凹模拟**：模拟人类视野中心的高清晰度区域
- **周边视觉模拟**：处理视野边缘的低清晰度信息
- **注视点计算**：基于页面内容重要性计算眼球注视位置
- **眼跳（Saccade）行为**：模拟眼球在注视点之间的快速跳跃

### 真实键盘输入模式
- **变速输入**：模拟不同字符的输入速度变化
- **突发式输入**：模拟人类连续快速输入后短暂停顿的模式
- **错误与纠正**：随机生成打字错误并模拟纠正行为
- **组合键使用**：模拟使用快捷键和组合键的行为

## 指纹混淆技术详解

### 浏览器特征混淆
- **用户代理轮换**：定期更换HTTP请求中的User-Agent字段
- **屏幕与窗口信息**：混淆屏幕分辨率和窗口尺寸信息
- **插件和MIME类型**：隐藏或修改浏览器插件和支持的MIME类型信息
- **字体列表混淆**：修改或限制可检测到的系统字体列表

### Canvas指纹保护
- **微量噪声注入**：在Canvas绘图中添加人眼无法察觉的微小噪声
- **不同渲染引擎模拟**：模拟不同浏览器的Canvas渲染差异
- **文本渲染保护**：特别保护文本渲染特征，避免基于字体的指纹识别
- **WebGL指纹混淆**：修改WebGL环境参数和渲染特征

### 高级网络特征保护
- **TCP/IP栈特征修改**：修改网络请求的TTL值、窗口大小等特征
- **TLS/SSL握手指纹**：混淆TLS握手中的加密套件顺序和扩展参数
- **HTTP/2特征混淆**：修改HTTP/2连接的帧优先级和流行为
- **DNS解析行为**：修改DNS解析模式，模拟不同网络环境

## 项目架构

### 核心模块
- **后台服务 (background.js)**：管理扩展生命周期和全局状态
- **内容脚本 (content.js)**：在目标网页中执行漏洞检测和行为模拟
- **人类行为模拟器 (human_behavior.js)**：提供真实人类行为模拟能力
- **指纹混淆器 (fingerprint.js)**：负责浏览器指纹的保护和混淆
- **漏洞检测引擎**：分析网页内容和交互，发现潜在安全问题
- **报告生成器**：汇总检测结果，生成可视化报告

### 通信流程
```
[后台服务] <--消息交换--> [内容脚本] <--DOM交互--> [网页]
    |                       |
    |                       |
[指纹混淆器]          [人类行为模拟器]
    |                       |
    |                       |
[网络请求拦截]        [DOM分析和交互]
```

## 安装说明

### 方法一：从Chrome Web Store安装
*(待发布)*

### 方法二：开发者模式安装
1. 下载本仓库并解压
2. 打开Chrome浏览器，进入扩展管理页面 (chrome://extensions/)
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择解压后的`browser_extension`文件夹
6. 安装完成后，浏览器工具栏将显示扩展图标

## 使用方法

1. 点击浏览器工具栏上的扩展图标，打开控制面板
2. 在控制面板中配置检测设置：
   - 选择检测模式（被动/主动）
   - 选择要检测的漏洞类型
   - 调整检测深度
3. 浏览目标网站，扩展将在后台进行检测
4. 检测到漏洞时，会显示通知
5. 点击"生成报告"查看详细的漏洞报告和修复建议

## 高级功能使用指南

### 自定义检测规则
1. 点击"高级设置"选项卡
2. 选择"自定义规则"
3. 使用提供的编辑器创建或修改检测规则
4. 点击"保存规则"使更改生效

### 批量目标扫描
1. 在控制面板中选择"批量操作"
2. 上传包含目标URL的CSV文件或逐行输入URL
3. 配置批量操作设置（访问间隔、每个目标的停留时间等）
4. 点击"开始批量检测"按钮

### 报告导出与共享
1. 在报告页面，点击"导出"按钮
2. 选择导出格式（HTML、PDF、CSV或JSON）
3. 可选择加密导出文件（适用于敏感信息）
4. 下载报告或使用"共享"功能直接发送报告

## 安全与合规性

- 本工具仅用于安全测试和教育目的
- 请仅在获得授权的网站上使用本工具
- 不当使用本工具可能违反法律法规和网站服务条款
- 尊重robots.txt规则和网站服务条款
- 保持合理的请求频率，避免造成服务器负担

## 技术特性

- 基于Chrome扩展API开发
- 使用现代JavaScript，符合ES6+标准
- 模块化设计，包括指纹混淆、漏洞检测、人类行为模拟等核心模块
- 智能负载生成器，能生成针对不同漏洞类型的测试负载

## 参与贡献

1. Fork本项目
2. 创建您的特性分支 `git checkout -b feature/amazing-feature`
3. 提交您的变更 `git commit -m 'Add some amazing feature'`
4. 推送到分支 `git push origin feature/amazing-feature`
5. 打开一个Pull Request

### 代码贡献指南
- 遵循项目的编码风格和命名约定
- 添加适当的注释和文档
- 确保代码通过所有测试
- 提交前进行代码审查

## 常见问题解答

### Q: 本工具是否只适用于Chrome浏览器？
A: 目前主要支持Chrome和基于Chromium的浏览器（如Edge）。未来可能会添加对Firefox的支持。

### Q: 使用本工具是否会留下痕迹？
A: 本工具设计时考虑了隐匿性，通过指纹混淆和真实人类行为模拟来降低被检测的风险。但无法保证100%不被检测。

### Q: 检测到的漏洞信息是否会上传到服务器？
A: 否，所有检测数据仅保存在本地浏览器存储中，不会上传到任何远程服务器。

### Q: 如何调整人类行为模拟的真实程度？
A: 在"行为模拟"设置中，可以选择不同的人格类型或手动调整各项参数，如鼠标移动速度、阅读时间等。

## 未来计划

- 添加对Firefox浏览器的支持
- 增强漏洞检测能力，支持更多类型的安全问题
- 改进人类行为模拟算法，提高真实性
- 添加基于机器学习的漏洞预测功能
- 支持自定义漏洞检测插件开发
- **深度学习漏洞检测**：利用深度学习模型识别复杂漏洞模式
- **行为异常检测**：通过学习正常用户行为模式，发现潜在的安全异常
- **多平台支持**：扩展对Firefox、Safari等更多浏览器的支持
- **API安全检测**：增强对REST API和GraphQL接口的安全检测能力
- **云端协同分析**：可选的云端协同分析功能，提高检测准确性（保持本地数据隐私）

## 许可证

本项目采用[LICENSE](LICENSE)文件中指定的许可证。 